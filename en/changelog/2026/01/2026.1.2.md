# v2026.1.2

Release date: **January 21, 2026**

---

## ‚ú® New Features

### Granular CRM Access Control

Implemented complete permissions system that allows precise control over what each agent can view in the CRM module. Now you can ensure each user has access only to data from customers they directly serve.

#### What is it for?

- ‚úÖ **Privacy and Security**: Confidential customer data is protected and accessible only to direct responsibles
- ‚úÖ **GDPR Compliance**: Meets data protection requirements and minimizes access to personal information
- ‚úÖ **Focused Experience**: Agents view only what they need for their work, with a cleaner and more objective interface
- ‚úÖ **Administrative Control**: Managers decide each user's access level according to business needs

#### How does it work?

**For Limited Agents (agent_limited)**:
1. CRM Menu: View only "My Customers" option
2. Funnel Screen: See only customers assigned to them
3. Automatic Filter: System automatically filters only their customers
4. No Toggle: Button to switch between "all" and "my customers" is hidden

**For Other Agents (agent)**:
1. CRM Menu: Can choose between "My Customers" and "All Customers"
2. Funnel Screen: Can use a toggle to switch views
3. Permissions: Can read and edit (but not create or delete)

**For Administrators and Managers**:
- Full access without restrictions
- View all customers
- Can manage pipelines and export data

#### How to configure?

1. Access the **Users** menu (administrative area)
2. Select the user you want to configure
3. In the **Permission/Role** field, choose **"Limited Agent"** (agent_limited)
4. Save changes

**Done!** The agent will only see their own customers in CRM.

#### Available Permission Types

- **Owner/Admin**: Full access without restrictions
- **Manager**: View all but with some administrative restrictions
- **Agent (Regular Agent)**: Access their customers + can see all if necessary
- **Agent Limited (Limited Agent)**: ‚≠ê **Recommended** - See ONLY their customers

---

### Customer Query by User Permission

Customer listing now respects logged-in user permissions across all system modules (Customers, CRM, and Services).

#### What is it for?

- ‚úÖ **Enhanced security**: Agents with `agent_limited` permission view only customers related to their own services
- ‚úÖ **Data privacy**: Prevents agents from accessing information about customers not assigned to them
- ‚úÖ **Compliance**: Meets data protection and privacy requirements
- ‚úÖ **Granular control**: Administrators maintain full access to the customer base

#### How does it work?

1. **For Administrators and Supervisors**: View all team customers normally
2. **For Agents with `agent_limited`**: 
   - View only customers from services assigned to them
   - Listing is automatically filtered based on `last_assigned_to` field
   - No additional configuration needed

---

## üîí Security

### Multi-level Customer Data Access Control

- **Interface (UI)**: Hides options and controls not permitted for user profile
- **Backend**: Specific database functions (`get_customers_by_stage_v2`, `get_stage_customer_counts_v2`) automatically filter data
- **Permissions**: Role system ensures only authorized data is accessed
- **Audit**: Access history maintained for traceability

### Technical Improvements

- Created v2 versions of CRM query functions with `last_assigned_to` filter
- Implemented `usePermissions` hook for role-based access control
- Added permission constants (`PERMISSION_TEMPLATES`) for all profiles
- Complete integration between Sidebar, CRMFunnel, and data hooks

---

## üéØ Benefits

- ‚úÖ **Greater privacy**: Customer data protected by multiple security layers
- ‚úÖ **GDPR compliance**: Meets data minimization and restricted access principles
- ‚úÖ **Simplified management**: Agents focus only on their customers
- ‚úÖ **Enhanced security**: Drastically reduces information leakage risks
- ‚úÖ **Optimized experience**: Cleaner and more objective interface for each user profile
- ‚úÖ **Flexibility**: Administrators can adjust permissions as needed
